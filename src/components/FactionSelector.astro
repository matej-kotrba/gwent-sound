---
import type { Faction } from "../Faction";

interface Props {
  factions: Faction[];
  id: number;
}

const { factions, id } = Astro.props;
---

<div class="faction-selector grid grid-cols-1 sm:grid-cols-2 gap-4 p-4">
  {
    factions.map((faction) => (
      <div
        class="faction-card border-2 border-transparent rounded-lg p-2 text-center cursor-pointer transition-all duration-300 ease-in-out transform hover:scale-105 hover:border-[var(--color-gwent-yellow-minion)] bg-gradient-to-br from-gray-800 to-gray-900 shadow-md"
        data-faction-id={faction.id}
      >
        <img
          src={faction.imagePath}
          alt={faction.name}
          class="w-24 h-24 mx-auto object-cover rounded-full"
        />
        <p class="mt-2 text-lg font-semibold">{faction.name}</p>
      </div>
    ))
  }
</div>

<script define:vars={{ id }}>
  document.querySelectorAll(".faction-card").forEach((card) => {
    card.addEventListener("click", () => {
      const factionId = card.getAttribute("data-faction-id");
      console.log(`Faction selected: ${factionId}`);
      // In a later step, this will be updated to dispatch a custom event.
      const event = new CustomEvent(`factionSelected-${id}`, {
        bubbles: true,
        composed: true,
        detail: { factionId },
      });
      card.dispatchEvent(event);
    });
  });
</script>
